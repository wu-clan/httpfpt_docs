## 变量和hooks说明

### 变量

- global: 全局变量, 仅在 data 目录下的 `global_vars.yaml` 文件中以键值对形式进行定义
- env: 环境变量, 在测试用例依赖的环境文件中以键值对的形式进行定义
- cache: 缓存变量, 在同一python包下运行测试用例时，在系统内存中定义

### hooks

仅在 data 目录下的 hooks.py 文件中定义，根据定义结构在用例数据文件中使用

## 变量表达式

变量和 hooks 开头请遵循规则: a-zA-Z_

- 普通变量：测试用例全局可用

   ```text
   ${var} 或 $var
   ```

- 关联测试用例变量：只在测试用例中含有关联测试用例提取并需要引用关联测试用例设置的变量时，使用此方式

   ```text
   ^{var} 或 ^var
   ```

- hooks：全局可用，在测试用例前后置 hooks 参数下只执行代码, 在其他地方使用时, 将执行代码并替换为返回值

   ```text
   ${func()}
   ```

## 用例中的变量替换

### 普通变量

请求数据解析时，寻找变量顺序为： cache > env > global，找到变量自动替换数据，未找到抛出异常

### 关联测试用例变量

关联测试用例执行后，在 cache 中设置变量，找到变量自动替换数据，未找到抛出异常

::: warning
默认仅使用 cache 存储关联变量，关联变量无法跨用例引用，只对当前运行的单个测试用例可用，当前用例运行后将自动清除
:::

## 变量存储说明

- env：在当前测试用例数据所调用的测试环境文件中进行持久化写入，键值不会重复，新值（新变量）覆盖旧值（重复命名变量）
- global: 在全局变量文件中进行持久化写入，键值不会重复，新值（新变量）覆盖旧值（重复命名变量）
- cache：写入当前正在运行的测试用例所在python包目录下的所有用例运行过程的内存中，不会持久化，同一python包目录下用例运行结束后自动清除

::: warning 提示
变量持久化写入会冲刷掉手写注释内容
:::
